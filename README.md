.# easy_monnify

`easy_monnify` is a Python library that simplifies the interaction with the Monnify payment gateway. This library wraps around the Monnify API, allowing users to make **GET** and **POST** requests to various Monnify endpoints with ease, without needing to handle the complexities of crafting HTTP requests.

## Features
- Simple and intuitive interface for interacting with Monnify's API.
- Functions to perform common operations such as checking wallet balance, initiating transactions, and more.
- Easily extendable to add more endpoints as Monnify evolves.

## Registration
To use this library effectively, ensure you have created an account with monnify. if not, kindly create an account here [https://app.monnify.com/create-account](https://app.monnify.com/create-account)

## Installation

You can install this library using pip (once it's published):
```bash
pip install easy_monnify
```

## Usage
### Basic setup

First, you'll need to create an instance of the Monnify class by passing your contract code and wallet account number:
```python
from  easy_monnify import Monnify

# Initialize the Monnify class with your API key, Client Secret Key and Environment
monnify = Monnify(apiKey="your_api_key", clientSecretKey="your_client_secret_key", environment="live")
# environment can either be "live" for production or "sandbox" for development.
# If no environment is specified, it defaults to "live"
```

### Available Functions

<table>
    <thead>
        <tr>
            <th>Category</th>
            <th>Functions</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Reserved Accounts</td>
            <td>
                <ul>
                    <li>Create Reserved Account</li>
                    <li>Get Reserved Account Details</li>
                    <li>Delete Reserved Accounts</li>
                    <li>Update BVN for Reserved Account</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>Transactions</td>
            <td>
                <ul>
                    <li>Initiate A Transaction</li>
                    <li>Pay With Bank Transfer</li>
                    <li>Pay With Card</li>
                    <li>Authroize OTP</li>
                    <li>Get Transactions For A Reserved Account</li>
                    <li>Get All Transactions / Search Transactions</li>
                    <li>Get A Transaction Details</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>Sub Accounts</td>
            <td>
                <ul>
                    <li>Create Sub Account</li>
                    <li>Delete Sub Account</li>
                    <li>Get All Sub Accounts</li>
                    <li>Update A Sub Account Info</li>
                    <li>Update Split Config For A Reserved Account</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>Transfers</td>
            <td>
                <ul>
                    <li>Initiate A Single Transfer</li>
                    <li>Authorize A Transfer / Validate OTP</li>
                    <li>Resend OTP</li>
                    <li>Get Transfer Status</li>
                    <li>Search Transfers</li>
                    <li>Get All Transfers</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>Wallet Account</td>
            <td>
                <ul>
                    <li>Get Wallet Balance</li>
                    <li>Get List of Banks (supported by Monnify) <a href="https://github.com/Rigantech/easy_monnify/blob/main/src/assets/banks.json">See sample list</a></li>
                    <li>Get All Available Bank USSDs (supported by Monnify) <a href="https://github.com/Rigantech/easy_monnify/blob/main/src/assets/banks_ussd.json">See sample list</a></li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>Bank Verification</td>
            <td>
                <ul>
                    <li>Verify Bank Account</li>
                    <li>Verify BVN Number (with Date of Birth)</li>
                    <li>Verify BVN Number (with Bank Account)</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>WebHooks</td>
            <td>
                <ul>
                    <li>Check Verified Valid Payment</li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>

### Usage

### Reserved Accounts
- Create Reserved Account
    ```python
    data = monnify.createReservedAccount(
        accountReference="reference_to_the_account", # generated by you to identify the account
        accountName="name_of_account.",
        currencyCode="NGN", # currency is in Naira
        contractCode="your_monnify_account_contract_code",- # see Monnify dashboard
        customerName="name_of_customer",
        customerEmail="email_of_customer",
    )
    ```
    - ```accountReference:``` String, Required
    - ```accountName:``` String, Required
    - ```currencyCode:``` String, Required, should be "NGN"
    - ```contractCode:``` String, Required
    - ```customerName:``` String, Required
    - ```customerEmail:``` String, Required

    #### sample response - success
    ```bash
    # status 200
    {
        "requestSuccessful": true,
        "responseMessage": "success",
        "responseCode": "0",
        "responseBody": {
            "contractCode": "4876165459",
            "accountReference": "jsnow1234",
            "accountName": "John Snow Limited",
            "currencyCode": "NGN",
            "customerEmail": "john@snow.com",
            "customerName": "John Snow Limited",
            "accountNumber": "9879377424",
            "bankName": "Providus Bank",
            "bankCode": "101",
            "status": "ACTIVE",
            "createdOn": "2019-12-08 15:52:04.726",
            "incomeSplitConfig": []
        }
    }
    ```
    #### sample response - error
    ```bash
    # status 400
    {
        "requestSuccessful": false,
        "responseMessage": "Field contractCode cannot be null",
        "responseCode": "99"
    }

    # status 401
    {
        "error": "invalid_token",
        "error_description": "Access token expired: -geneerated_access_token"
    }

    # status 422
    {
        "requestSuccessful": false,
        "responseMessage": "You can not reserve two accounts with the same reference",
        "responseCode": "99"
    }
    ```

- Get Reserved Account Details
    ```python
    data = monnify.getReservedAccountDetails(
        accountReference="reference_to_the_account"
    )
    ```
    - ```accountReference:``` String, Required

    #### sample response - success
    ```bash
    # status 200
    {
        "requestSuccessful": true,
        "responseMessage": "success",
        "responseCode": "0",
        "responseBody": {
            "contractCode": "4876165459",
            "accountReference": "Elmref6",
            "accountName": "Elmer Martin",
            "currencyCode": "NGN",
            "customerEmail": "tobi@toio.com",
            "customerName": "Mr Tobi",
            "accountNumber": "3225593799",
            "bankName": "Providus Bank",
            "bankCode": "101",
            "reservationReference": "L6KHK65ZSZJ23CKTFJKT",
            "status": "ACTIVE",
            "createdOn": "2019-11-05 12:03:16.0",
            "contract": {
            "name": "Default Contract",
            "code": "4876165459",
            "description": null,
            "supportsAdvancedSettlementAccountSelection": false
            },
            "totalAmount": 10500,
            "transactionCount": 3
        }
    }
    ```
    #### sample response - error
    ```bash
    # status 401
    {
        "error": "invalid_token",
        "error_description": "Cannot convert access token to JSON"
    }

    # status 404
    {
        "requestSuccessful": false,
        "responseMessage": "Cannot find reserved account",
        "responseCode": "99"
    }
    ```

- Delete Reserved Account
    ```python
    data = monnify.deleteReservedAccount(
        accountReference="reference_to_the_account"
    )
    ```
    - ```accountReference:``` String, Required

    #### sample response - success
    ```bash
    # status 200
    {
        "requestSuccessful": true,
        "responseMessage": "success",
        "responseCode": "0",
        "responseBody": {
            "contractCode": "4876165459",
            "accountReference": "1576076454948",
            "accountName": "Test Payment",
            "currencyCode": "NGN",
            "customerEmail": "johndoe@email.com",
            "customerName": "John Doe",
            "accountNumber": "9749142778",
            "bankName": "Providus Bank",
            "bankCode": "101",
            "reservationReference": "HJ2YVQ63VAHETLUB94FN",
            "status": "ACTIVE",
            "createdOn": "2019-12-11 15:00:56.0"
        }
    }
    ```
    #### sample response - error
    ```bash
    # status 401
    {
        "error": "invalid_token",
        "error_description": "Cannot convert access token to JSON"
    }

    # status 404
    {
        "requestSuccessful": false,
        "responseMessage": "Cannot find reserved account",
        "responseCode": "99"
    }
    ```




- Update BVN For Reserved Account
    ```python
    data = monnify.updateBVN(
        accountReference="reference_to_the_account",
        bvn="bvn_of_account_owner"
    )
    ```
    - ```accountReference:``` String, Required
    - ```bvn:``` String, required

    #### sample response - success
    ```bash
    # status 200
    {
        "requestSuccessful": true,
        "responseMessage": "BVN updated successfully",
        "responseCode": "00",
        "bvn": "12345678901",
        "accountReference": "ACC_REF_12345",
        "reservedAccount": {
            "accountName": "John Doe",
            "accountNumber": "0123456789",
            "bankCode": "101",
            "bankName": "Providus Bank"
        }
    }
    ```
    #### sample response - error
    ```bash
    # status 401
    {
        "error": "invalid_token",
        "error_description": "Cannot convert access token to JSON"
    }

    # status 404
    {
        "requestSuccessful": false,
        "responseMessage": "Account not found",
        "responseCode": "404",
        "accountReference": "ACC_REF_12345"
    }

    {
        "requestSuccessful": false,
        "responseMessage": "BVN already associated with the account",
        "responseCode": "01",
        "bvn": "12345678901",
        "accountReference": "ACC_REF_12345"
    }
    ```

### Transactions





